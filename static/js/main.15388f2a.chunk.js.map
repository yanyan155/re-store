{"version":3,"sources":["components/shop-header/index.js","components/shop-header/shop-header.tsx","components/book-list-item/index.js","components/book-list-item/book-list-item.tsx","components/bookstore-service-context/bookstore-service-context.js","components/hoc/with-bookstore-service.tsx","types.ts","actions/index.ts","utils/compose.ts","components/spinner/index.js","components/spinner/spinner.tsx","components/error-indicator/index.js","components/error-indicator/error-indicator.tsx","components/book-list/book-list.tsx","components/book-list/index.js","components/shopping-cart-table/shopping-cart-table.tsx","components/pages/home-page.tsx","components/pages/cart-page.tsx","components/app/index.js","components/app/app.tsx","components/error-boundry/error-boundry.tsx","store.ts","components/error-boundry/index.js","services/bookstore-service.ts","reducers/book-list.ts","reducers/shopping-cart.ts","reducers/index.ts","index.tsx"],"names":["ShopHeader","_ref","numItems","total","React","createElement","className","Link","to","BookListItem","book","onAddedToCart","title","author","price","coverImage","src","alt","onClick","_React$createContext","createContext","BookstoreServiceProvider","Provider","BookstoreServiceConsumer","Consumer","withBookstoreService","Wrapped","props","bookstoreService","Object","assign","ActionTypes","bookAddedToCart","bookId","type","payload","fetchBooks","dispatch","getBooks","then","data","newBooks","catch","err","error","compose","_len","arguments","length","funcs","Array","_key","comp","reduceRight","wrapped","f","Spinner","ErrorIndicator","BookList","books","map","key","id","BookListContainer","_Component","_classCallCheck","this","_callSuper","_inherits","_createClass","value","_this$props","loading","Component","connect","_ref2","_ref2$bookList","bookList","_ref3","bindActionCreators","mapDispatchToProps","onIncrease","onDecrease","onDelete","_ref2$shoppingCart","shoppingCart","items","cartItems","orderTotal","item","idx","count","HomePage","ShoppingCartTable","CartPage","App","el","reduce","a","b","role","Switch","Route","path","component","exact","timeout","ErrorBoundry","_this","args","concat","state","hasError","setState","children","BookstoreService","Promise","resolve","reject","setTimeout","Math","random","Error","updateBookList","action","undefined","FETCH_BOOKS_REQUEST","FETCH_BOOKS_SUCCESS","FETCH_BOOKS_FAILURE","updateCartItems","_toConsumableArray","slice","updateOrder","quantity","_state$shoppingCart","find","itemIndex","findIndex","newItem","_item$id","_item$count","_item$title","_item$total","updateCartItem","updateShoppingCart","BOOK_ADDED_TO_CART","BOOK_REMOVED_FROM_CART","ALL_BOOKS_REMOVED_FROM_CART","reducer","store","createStore","applyMiddleware","thunkMiddleware","next","getState","console","log","ReactDOM","render","Router","document","getElementById"],"mappings":"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","file":"static/js/main.15388f2a.chunk.js","sourcesContent":["import ShopHeader from './shop-header';\r\n\r\nexport default ShopHeader;","import React from \"react\";\r\nimport \"./shop-header.css\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\ninterface Iprops {\r\n  numItems: any;\r\n  total: any;\r\n}\r\n\r\nconst ShopHeader = ({ numItems, total }: Iprops) => {\r\n  return (\r\n    <header className=\"shop-header row\">\r\n      <Link to=\"/\">\r\n        <div className=\"logo text-dark\">ReStore</div>\r\n      </Link>\r\n      <Link to=\"/cart\">\r\n        <div className=\"shopping-cart\">\r\n          <i className=\"cart-icon fa fa-shopping-cart\" />\r\n          {numItems} items (${total})\r\n        </div>\r\n      </Link>\r\n    </header>\r\n  );\r\n};\r\n\r\nexport default ShopHeader;\r\n","import BookListItem from './book-list-item';\r\n\r\nexport default BookListItem;\r\n","import React, { MouseEventHandler } from \"react\";\r\nimport \"./book-list-item.css\";\r\nimport { Book } from \"../../types\";\r\n\r\ninterface IProps extends Book {\r\n  book: Book;\r\n  onAddedToCart: MouseEventHandler<HTMLButtonElement>;\r\n}\r\nconst BookListItem = ({ book, onAddedToCart }: IProps) => {\r\n  const { title, author, price, coverImage } = book;\r\n  return (\r\n    <div className=\"book-list-item\">\r\n      <div className=\"book-cover\">\r\n        <img src={coverImage} alt=\"cover\" />\r\n      </div>\r\n      <div className=\"book-details\">\r\n        <span className=\"book-title\">{title}</span>\r\n        <div className=\"book-author\">{author}</div>\r\n        <div className=\"book-price\">${price}</div>\r\n        <button onClick={onAddedToCart} className=\"btn btn-info add-to-cart\">\r\n          Add to cart\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BookListItem;\r\n","import React from 'react';\r\n\r\nconst {\r\n  Provider: BookstoreServiceProvider,\r\n  Consumer: BookstoreServiceConsumer\r\n} = React.createContext();\r\n\r\nexport {\r\n  BookstoreServiceProvider,\r\n  BookstoreServiceConsumer\r\n};\r\n","import React from \"react\";\r\nimport { BookstoreServiceConsumer } from \"../bookstore-service-context\";\r\nimport BookstoreService from \"../../services/bookstore-service\";\r\n\r\ntype Props = {\r\n  [key: string]: any;\r\n};\r\n\r\n// https://stackoverflow.com/questions/61853338/property-does-not-exist-on-type-intrinsicattributes-children-reactnode\r\nconst withBookstoreService = () => (\r\n  Wrapped: React.FC<Props>\r\n): React.FC<Props> => {\r\n  return (props: Props) => {\r\n    return (\r\n      <BookstoreServiceConsumer>\r\n        {(bookstoreService: BookstoreService) => {\r\n          return (\r\n            <Wrapped\r\n              {...(props as object)}\r\n              bookstoreService={bookstoreService}\r\n            />\r\n          );\r\n        }}\r\n      </BookstoreServiceConsumer>\r\n    );\r\n  };\r\n};\r\n\r\nexport default withBookstoreService;\r\n","import BookstoreService from \"./services/bookstore-service\";\r\n\r\nexport type Error = typeof Error;\r\nexport type BookId = number;\r\nexport type BookTitle = string;\r\nexport interface Book {\r\n  id: BookId;\r\n  title: BookTitle;\r\n  author: string;\r\n  price: number;\r\n  coverImage: string;\r\n}\r\nexport type typeBookstoreService = InstanceType<typeof BookstoreService>;\r\n\r\nexport enum ActionTypes {\r\n  \"FETCH_BOOKS_REQUEST\" = \"FETCH_BOOKS_REQUEST\",\r\n  \"FETCH_BOOKS_SUCCESS\" = \"FETCH_BOOKS_SUCCESS\",\r\n  \"FETCH_BOOKS_FAILURE\" = \"FETCH_BOOKS_FAILURE\",\r\n  \"BOOK_ADDED_TO_CART\" = \"BOOK_ADDED_TO_CART\",\r\n  \"BOOK_REMOVED_FROM_CART\" = \"BOOK_REMOVED_FROM_CART\",\r\n  \"ALL_BOOKS_REMOVED_FROM_CART\" = \"ALL_BOOKS_REMOVED_FROM_CART\",\r\n  \"DELAYED_ACTION\" = \"DELAYED_ACTION\",\r\n}\r\n\r\ninterface ActionFetchBooksAndDelayed {\r\n  type: ActionTypes.FETCH_BOOKS_REQUEST | ActionTypes.DELAYED_ACTION;\r\n}\r\n\r\ninterface ActionFetchSuccess {\r\n  type: ActionTypes.FETCH_BOOKS_SUCCESS;\r\n  payload: Books;\r\n}\r\n\r\ninterface ActionErrorFetch {\r\n  type: ActionTypes.FETCH_BOOKS_FAILURE;\r\n  payload: Error;\r\n}\r\n\r\nexport interface ActionCartManipulation {\r\n  type:\r\n    | ActionTypes.BOOK_ADDED_TO_CART\r\n    | ActionTypes.BOOK_REMOVED_FROM_CART\r\n    | ActionTypes.ALL_BOOKS_REMOVED_FROM_CART;\r\n  payload: BookId;\r\n}\r\n\r\nexport type Actions = ActionsFetch | ActionCartManipulation;\r\n\r\nexport type ActionsFetch =\r\n  | ActionFetchBooksAndDelayed\r\n  | ActionFetchSuccess\r\n  | ActionErrorFetch;\r\n\r\nexport type GetBook = Promise<Books>;\r\nexport type Books = Book[];\r\n\r\nexport interface CartItem {\r\n  id: BookId;\r\n  title: BookTitle;\r\n  count: number;\r\n  total: number;\r\n}\r\nexport type CartItems = CartItem[];\r\n\r\nexport interface ShoppingCart {\r\n  cartItems: CartItems;\r\n  orderTotal: number;\r\n}\r\nexport interface BooksList {\r\n  books: Books;\r\n  loading: boolean;\r\n  error: null | Error;\r\n}\r\n\r\nexport interface AppState {\r\n  bookList: BooksList;\r\n  shoppingCart: ShoppingCart;\r\n}\r\n\r\nexport type DispatchType = (args: Actions) => Actions;\r\n\r\n// https://redux.js.org/usage/usage-with-typescript#type-checking-middleware\r\n// https://www.freecodecamp.org/news/how-to-use-redux-in-your-react-typescript-app/\r\n","import { Dispatch } from \"redux\";\r\n\r\nimport {\r\n  Error,\r\n  BookId,\r\n  Book,\r\n  typeBookstoreService,\r\n  ActionTypes,\r\n} from \"../types\";\r\n\r\nconst booksRequested = () => {\r\n  return {\r\n    type: ActionTypes[\"FETCH_BOOKS_REQUEST\"],\r\n  };\r\n};\r\n\r\nconst booksLoaded = (newBooks: Book[]) => {\r\n  return {\r\n    type: ActionTypes[\"FETCH_BOOKS_SUCCESS\"],\r\n    payload: newBooks,\r\n  };\r\n};\r\n\r\nconst booksError = (error: Error) => {\r\n  return {\r\n    type: ActionTypes[\"FETCH_BOOKS_FAILURE\"],\r\n    payload: error,\r\n  };\r\n};\r\n\r\nexport const bookAddedToCart = (bookId: BookId) => {\r\n  return {\r\n    type: ActionTypes[\"BOOK_ADDED_TO_CART\"],\r\n    payload: bookId,\r\n  };\r\n};\r\n\r\nexport const bookRemovedFromCart = (bookId: BookId) => {\r\n  return {\r\n    type: ActionTypes[\"BOOK_REMOVED_FROM_CART\"],\r\n    payload: bookId,\r\n  };\r\n};\r\n\r\nexport const allBooksRemovedFromCart = (bookId: BookId) => {\r\n  return {\r\n    type: ActionTypes[\"ALL_BOOKS_REMOVED_FROM_CART\"],\r\n    payload: bookId,\r\n  };\r\n};\r\n\r\n// const fetchBooksOld = (bookstoreService, dispatch) => () => {\r\n//   dispatch(booksRequested());\r\n//   bookstoreService\r\n//     .getBooks()\r\n//     .then((data: Book[]) => dispatch(booksLoaded(data)))\r\n//     .catch((err: Error) => dispatch(booksError(err)));\r\n// };\r\n\r\nconst fetchBooks = (bookstoreService: typeBookstoreService) => () => (\r\n  dispatch: Dispatch\r\n) => {\r\n  dispatch(booksRequested());\r\n  bookstoreService\r\n    .getBooks()\r\n    .then((data: Book[]) => dispatch(booksLoaded(data)))\r\n    .catch((err: Error) => dispatch(booksError(err)));\r\n};\r\n\r\nexport { fetchBooks };\r\n","import { Component } from \"react\";\r\n\r\nconst compose = (...funcs: Function[]) => (comp: typeof Component) => {\r\n  return funcs.reduceRight((wrapped, f) => f(wrapped), comp);\r\n};\r\n\r\nexport default compose;\r\n","import Spinner from './spinner';\r\n\r\nexport default Spinner;\r\n","import React from 'react';\r\nimport './spinner.css';\r\n\r\nconst Spinner = () => {\r\n  return <div>loading...</div>;\r\n};\r\n\r\nexport default Spinner;\r\n","import ErrorIndicator from './error-indicator';\r\n\r\nexport default ErrorIndicator;\r\n","import React from 'react';\r\nimport './error-indicator.css';\r\n\r\nconst ErrorIndicator = () => {\r\n  return <div>Error!</div>;\r\n};\r\n\r\nexport default ErrorIndicator;\r\n","import React, { Component } from \"react\";\r\nimport BookListItem from \"../book-list-item\";\r\n\r\nimport { bindActionCreators, Dispatch } from \"redux\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport { withBookstoreService } from \"../hoc\";\r\nimport { fetchBooks, bookAddedToCart } from \"../../actions\";\r\nimport { compose } from \"../../utils\";\r\n\r\nimport Spinner from \"../spinner\";\r\nimport ErrorIndicator from \"../error-indicator\";\r\n\r\nimport \"./book-list.css\";\r\nimport { AppState } from \"../../types\";\r\n\r\nimport { Books, typeBookstoreService, BooksList } from \"../../types\";\r\n\r\ninterface BookListProps {\r\n  books: Books;\r\n  onAddedToCart: (id: number) => void;\r\n}\r\n\r\nconst BookList = ({ books, onAddedToCart }: BookListProps) => {\r\n  return (\r\n    <ul className=\"book-list\">\r\n      {books.map((book) => {\r\n        return (\r\n          <li key={book.id}>\r\n            {/* @ts-expect-error */}\r\n            <BookListItem\r\n              book={book}\r\n              onAddedToCart={() => onAddedToCart(book.id)}\r\n            />\r\n          </li>\r\n        );\r\n      })}\r\n    </ul>\r\n  );\r\n};\r\n\r\ninterface BookListContainerProps extends BooksList {\r\n  fetchBooks: () => (dispatch: Dispatch) => void;\r\n  onAddedToCart: (id: number) => void;\r\n}\r\n\r\nclass BookListContainer extends Component<BookListContainerProps> {\r\n  componentDidMount() {\r\n    this.props.fetchBooks();\r\n  }\r\n\r\n  render() {\r\n    const { books, loading, error, onAddedToCart } = this.props;\r\n\r\n    if (loading) {\r\n      return <Spinner />;\r\n    }\r\n\r\n    if (error) {\r\n      return <ErrorIndicator />;\r\n    }\r\n\r\n    return <BookList books={books} onAddedToCart={onAddedToCart} />;\r\n  }\r\n}\r\n\r\nconst mapStateToProps = ({ bookList: { books, loading, error } }: AppState) => {\r\n  return { books, loading, error };\r\n};\r\n\r\ninterface MapDispatchToProps {\r\n  bookstoreService: typeBookstoreService;\r\n}\r\n\r\nconst mapDispatchToProps = (\r\n  dispatch: any,\r\n  { bookstoreService }: MapDispatchToProps\r\n) => {\r\n  return bindActionCreators(\r\n    {\r\n      fetchBooks: fetchBooks(bookstoreService),\r\n      onAddedToCart: bookAddedToCart,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport default compose(\r\n  withBookstoreService(),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(BookListContainer);\r\n","import BookList from './book-list';\r\n\r\nexport default BookList;\r\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { ShoppingCart, CartItem } from \"../../types\";\r\n\r\nimport {\r\n  bookAddedToCart,\r\n  bookRemovedFromCart,\r\n  allBooksRemovedFromCart,\r\n} from \"../../actions\";\r\n\r\nimport \"./shopping-cart-table.css\";\r\n\r\ninterface MapStateToProps {\r\n  shoppingCart: ShoppingCart;\r\n}\r\n\r\ninterface Iprops {\r\n  items: ShoppingCart[\"cartItems\"];\r\n  total: ShoppingCart[\"orderTotal\"];\r\n  onIncrease: (id: number) => void;\r\n  onDecrease: (id: number) => void;\r\n  onDelete: (id: number) => void;\r\n}\r\n\r\nconst ShoppingCartTable = ({\r\n  items,\r\n  total,\r\n  onIncrease,\r\n  onDecrease,\r\n  onDelete,\r\n}: Iprops) => {\r\n  const renderRow = (item: CartItem, idx: number) => {\r\n    const { id, title, count, total } = item;\r\n    return (\r\n      <tr key={id}>\r\n        <td>{idx + 1}</td>\r\n        <td>{title}</td>\r\n        <td>{count}</td>\r\n        <td>${total}</td>\r\n        <td>\r\n          <button\r\n            onClick={() => onDelete(id)}\r\n            className=\"btn btn-outline-danger btn-sm float-right\"\r\n          >\r\n            <i className=\"fa fa-trash-o\" />\r\n          </button>\r\n          <button\r\n            onClick={() => onIncrease(id)}\r\n            className=\"btn btn-outline-success btn-sm float-right\"\r\n          >\r\n            <i className=\"fa fa-plus-circle\" />\r\n          </button>\r\n          <button\r\n            onClick={() => onDecrease(id)}\r\n            className=\"btn btn-outline-warning btn-sm float-right\"\r\n          >\r\n            <i className=\"fa fa-minus-circle\" />\r\n          </button>\r\n        </td>\r\n      </tr>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"shopping-cart-table\">\r\n      <h2>Your Order</h2>\r\n      <table className=\"table\">\r\n        <thead>\r\n          <tr>\r\n            <th>#</th>\r\n            <th>Item</th>\r\n            <th>Count</th>\r\n            <th>Price</th>\r\n            <th>Action</th>\r\n          </tr>\r\n        </thead>\r\n\r\n        <tbody>{items.map(renderRow)}</tbody>\r\n      </table>\r\n\r\n      <div className=\"total\">Total: ${total}</div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = ({\r\n  shoppingCart: { cartItems, orderTotal },\r\n}: MapStateToProps) => {\r\n  return {\r\n    items: cartItems,\r\n    total: orderTotal,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  onIncrease: bookAddedToCart,\r\n  onDecrease: bookRemovedFromCart,\r\n  onDelete: allBooksRemovedFromCart,\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ShoppingCartTable);\r\n","import React from 'react';\r\nimport BookList from '../book-list';\r\nimport ShoppingCartTable from '../shopping-cart-table/shopping-cart-table';\r\n\r\nconst HomePage = () => {\r\n  return (\r\n    <div>\r\n      <BookList />\r\n      <ShoppingCartTable />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HomePage;\r\n","import React from 'react';\r\n\r\nconst CartPage = () => {\r\n  return <div>Cart Page</div>\r\n};\r\n\r\nexport default CartPage;\r\n","import App from './app';\r\n\r\nexport default App;\r\n","import React from \"react\";\r\nimport { Route, Switch } from \"react-router-dom\";\r\nimport ShopHeader from \"../shop-header\";\r\nimport { HomePage, CartPage } from \"../pages\";\r\nimport { ShoppingCart } from \"../../types\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport \"./app.css\";\r\n\r\ninterface IProps {\r\n  numItems: number;\r\n  total: number;\r\n}\r\n\r\nconst App = ({ numItems, total }: IProps) => {\r\n  return (\r\n    <main role=\"main\" className=\"container\">\r\n      <ShopHeader numItems={numItems} total={total} />\r\n      <Switch>\r\n        <Route path=\"/\" component={HomePage} exact />\r\n\r\n        <Route path=\"/cart\" component={CartPage} />\r\n      </Switch>\r\n    </main>\r\n  );\r\n};\r\n\r\ninterface MapStateToProps {\r\n  shoppingCart: ShoppingCart;\r\n}\r\n\r\nconst mapStateToProps = ({\r\n  shoppingCart: { cartItems, orderTotal },\r\n}: MapStateToProps) => {\r\n  return {\r\n    numItems: cartItems.map((el) => el.count).reduce((a, b) => a + b, 0),\r\n    total: orderTotal,\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps)(App);\r\n","import React, { Component } from \"react\";\r\nimport ErrorIndicator from \"../error-indicator\";\r\n\r\nexport default class ErrorBoundry extends Component {\r\n  state = {\r\n    hasError: false,\r\n  };\r\n\r\n  componentDidCatch() {\r\n    this.setState({ hasError: true });\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return <ErrorIndicator />;\r\n    }\r\n\r\n    return this.props.children as JSX.Element;\r\n  }\r\n}\r\n","import { createStore, applyMiddleware, Middleware, Reducer } from \"redux\";\r\nimport thunkMiddleware, {\r\n  ThunkAction,\r\n  ThunkDispatch,\r\n  ThunkMiddleware,\r\n} from \"redux-thunk\";\r\nimport { AppState, Actions, DispatchType, ActionTypes } from \"./types\";\r\n\r\nimport reducer from \"./reducers\";\r\n\r\n// https://stackoverflow.com/questions/66920571/how-to-type-redux-thunk-with-middleware-in-typescript\r\nconst logMiddleware: Middleware<{}, AppState> = ({ getState }) => (\r\n  next: DispatchType\r\n) => (action: Actions) => {\r\n  console.log(action.type, getState());\r\n  return next(action);\r\n};\r\n\r\nconst stringMiddleware = () => (next: DispatchType) => (action: Actions) => {\r\n  if (typeof action === \"string\") {\r\n    return next({\r\n      type: action,\r\n    });\r\n  }\r\n\r\n  return next(action);\r\n};\r\n\r\n// https://stackoverflow.com/questions/64857870/how-to-dispatch-thunkaction-with-redux-thunk-and-typescript\r\nconst store = createStore(\r\n  // https://redux.js.org/api/createstore\r\n  reducer as Reducer<AppState, Actions>,\r\n  applyMiddleware(\r\n    //  https://stackoverflow.com/questions/64857870/how-to-dispatch-thunkaction-with-redux-thunk-and-typescript\r\n    thunkMiddleware as ThunkMiddleware<AppState, Actions, any>,\r\n    stringMiddleware,\r\n    logMiddleware\r\n  )\r\n);\r\n\r\nexport const delayedActionCreator = (\r\n  timeout: number\r\n): ThunkAction<void, AppState, unknown, Actions> => (dispatch) => {\r\n  setTimeout(\r\n    () =>\r\n      dispatch({\r\n        type: ActionTypes[\"DELAYED_ACTION\"],\r\n      }),\r\n    timeout\r\n  );\r\n};\r\n// https://stackoverflow.com/questions/64857870/how-to-dispatch-thunkaction-with-redux-thunk-and-typescript\r\n(store.dispatch as ThunkDispatch<AppState, unknown, Actions>)(\r\n  delayedActionCreator(3000)\r\n);\r\n\r\nexport default store;\r\n","import ErrorBoundry from './error-boundry';\r\n\r\nexport default ErrorBoundry;\r\n","import { GetBook, Books } from \"../types\";\r\n\r\nexport default class BookstoreService {\r\n  data: Books = [\r\n    {\r\n      id: 1,\r\n      title: \"Production-Ready Microservices\",\r\n      author: \"Susan J. Fowler\",\r\n      price: 32,\r\n      coverImage:\r\n        \"https://images-na.ssl-images-amazon.com/images/I/41yJ75gpV-L._SX381_BO1,204,203,200_.jpg\",\r\n    },\r\n    {\r\n      id: 2,\r\n      title: \"Release It!\",\r\n      author: \"Michael T. Nygard\",\r\n      price: 45,\r\n      coverImage:\r\n        \"https://images-na.ssl-images-amazon.com/images/I/414CRjLjwgL._SX403_BO1,204,203,200_.jpg\",\r\n    },\r\n  ];\r\n\r\n  getBooks(): GetBook {\r\n    return new Promise((resolve, reject) => {\r\n      setTimeout(() => {\r\n        if (Math.random() > 0.75) {\r\n          reject(new Error(\"Something bad happened\"));\r\n        } else {\r\n          resolve(this.data);\r\n        }\r\n      }, 700);\r\n    });\r\n  }\r\n}\r\n","import { ActionTypes, ActionsFetch, AppState, BooksList } from \"../types\";\r\n\r\nconst updateBookList = (state: AppState, action: ActionsFetch): BooksList => {\r\n  if (state === undefined) {\r\n    return {\r\n      books: [],\r\n      loading: true,\r\n      error: null,\r\n    };\r\n  }\r\n\r\n  switch (action.type) {\r\n    case ActionTypes.FETCH_BOOKS_REQUEST:\r\n      return {\r\n        books: [],\r\n        loading: true,\r\n        error: null,\r\n      };\r\n\r\n    case ActionTypes.FETCH_BOOKS_SUCCESS:\r\n      return {\r\n        books: action.payload,\r\n        loading: false,\r\n        error: null,\r\n      };\r\n\r\n    case ActionTypes.FETCH_BOOKS_FAILURE:\r\n      return {\r\n        books: [],\r\n        loading: false,\r\n        error: action.payload,\r\n      };\r\n\r\n    default:\r\n      return state.bookList;\r\n  }\r\n};\r\n\r\nexport default updateBookList;\r\n","import {\r\n  ActionTypes,\r\n  ActionCartManipulation,\r\n  AppState,\r\n  BookId,\r\n  CartItem,\r\n  CartItems,\r\n  Book,\r\n} from \"../types\";\r\n\r\nconst updateCartItems = (cartItems: CartItems, item: CartItem, idx: number) => {\r\n  if (item.count === 0) {\r\n    return [...cartItems.slice(0, idx), ...cartItems.slice(idx + 1)];\r\n  }\r\n\r\n  if (idx === -1) {\r\n    return [...cartItems, item];\r\n  }\r\n\r\n  return [...cartItems.slice(0, idx), item, ...cartItems.slice(idx + 1)];\r\n};\r\n\r\nconst updateCartItem = (book: Book, item = {}, quantity: number) => {\r\n  // @ts-ignore\r\n  const { id = book.id, count = 0, title = book.title, total = 0 } = item;\r\n\r\n  return {\r\n    id,\r\n    title,\r\n    count: count + quantity,\r\n    total: total + quantity * book.price,\r\n  };\r\n};\r\n\r\nconst updateOrder = (state: AppState, bookId: BookId, quantity: number) => {\r\n  const {\r\n    bookList: { books },\r\n    shoppingCart: { cartItems, orderTotal },\r\n  } = state;\r\n\r\n  const book = books.find(({ id }) => id === bookId) as Book;\r\n  const itemIndex = cartItems.findIndex(({ id }) => id === bookId);\r\n  const item = cartItems[itemIndex];\r\n\r\n  const newItem = updateCartItem(book, item, quantity);\r\n  return {\r\n    orderTotal: orderTotal + quantity * book.price,\r\n    cartItems: updateCartItems(cartItems, newItem, itemIndex),\r\n  };\r\n};\r\n\r\nconst updateShoppingCart = (\r\n  state: AppState,\r\n  action: ActionCartManipulation\r\n) => {\r\n  if (state === undefined) {\r\n    return {\r\n      cartItems: [],\r\n      orderTotal: 0,\r\n    };\r\n  }\r\n\r\n  switch (action.type) {\r\n    case ActionTypes.BOOK_ADDED_TO_CART:\r\n      return updateOrder(state, action.payload, 1);\r\n\r\n    case ActionTypes.BOOK_REMOVED_FROM_CART:\r\n      return updateOrder(state, action.payload, -1);\r\n\r\n    case ActionTypes.ALL_BOOKS_REMOVED_FROM_CART:\r\n      const item = state.shoppingCart.cartItems.find(\r\n        ({ id }) => id === action.payload\r\n      ) as CartItem;\r\n      return updateOrder(state, action.payload, -item.count);\r\n\r\n    default:\r\n      return state.shoppingCart;\r\n  }\r\n};\r\n\r\nexport default updateShoppingCart;\r\n","import updateBookList from \"./book-list\";\r\nimport updateShoppingCart from \"./shopping-cart\";\r\n\r\nimport {\r\n  Actions,\r\n  AppState,\r\n  ActionCartManipulation,\r\n  ActionsFetch,\r\n} from \"../types\";\r\n\r\nconst reducer = (state: AppState, action: Actions) => {\r\n  return {\r\n    bookList: updateBookList(state, action as ActionsFetch),\r\n    shoppingCart: updateShoppingCart(state, action as ActionCartManipulation),\r\n  };\r\n};\r\n\r\nexport default reducer;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\nimport { BrowserRouter as Router } from 'react-router-dom';\r\n\r\nimport App from './components/app';\r\nimport ErrorBoundry from './components/error-boundry';\r\nimport BookstoreService from './services/bookstore-service';\r\nimport { BookstoreServiceProvider } from './components/bookstore-service-context';\r\n\r\nimport store from './store';\r\n\r\nconst bookstoreService = new BookstoreService();\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <ErrorBoundry>\r\n      <BookstoreServiceProvider value={bookstoreService}>\r\n        <Router>\r\n          <App />\r\n        </Router>\r\n      </BookstoreServiceProvider>\r\n    </ErrorBoundry>\r\n  </Provider>,\r\n  document.getElementById('root')\r\n);"],"sourceRoot":""}